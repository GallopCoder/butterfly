package com.ali.retail;


import com.ali.retail.bean.DataBeanParent;
import com.ali.retail.common.forkjoin.DetectTask;
import com.ali.retail.prism.MysqlUtil;
import com.ali.retail.prism.PrismSystemInitializer;
import com.ali.retail.prism.PrismUtil;
import com.ali.retail.prism_r.PrismUtil_r;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableAsync;
import org.springframework.scheduling.annotation.EnableScheduling;

import java.util.*;

@SpringBootApplication
@EnableScheduling //开启定时任务
@EnableAsync  //开启异步任务
public class BlackSoilApplication {

    public static void main(String[] args) throws Exception{
        SpringApplication.run(BlackSoilApplication.class, args);
        String sys_name = "ps";
        PrismSystemInitializer.init(sys_name,"PrismSystem-alarm.conf");
        Map<String, Map<String, Set<String>>> map = new HashMap<>();
        map.put("ps", MysqlUtil.getNecessaryResult(MysqlUtil.getConnection(),"SELECT * FROM vt_subject sub ORDER BY sub.id DESC"));
        com.ali.retail.prism.PrismUtil.addTerms(sys_name, map);
        DetectTask.forkJoinTest();
//        PrismUtil.init();

//        prismForRedisTest();
//        prismForRedisTest();
//        PrismForMysqlTest();
    }


    public static void prismForRedisTest(){
        PrismUtil_r.init();
        Runnable runnable =() -> {
            try {
//                List<String> key = Arrays.asList("书仙画仙","书仙|王文森","潮州画仙","书仙画仙棋仙", "王文森+潮州","鸽子养殖场");
                String text = "安安~2020年本园第7胎开眼照报告 生产日期： 2020.03.25，拍照日：04.15 公犬：豊天秀将号-台湾信福园     祖父犬：豊天国正号（台湾信福园）     祖母犬：奈号（台湾信福园） 母犬: 宝樱姬号- 台湾信福园     外祖父犬:樱宝锦号(新化扬铭庄)     外祖母犬:吉野樱子号(台湾信福园) 生产头数: 赤公柴3只,合计3只 犬名预备：豊天樱锦.豊天樱王.豊天樱太 特宠业繁字第I1070048-00号(来源:脸书账号采集)";
                String title = "我爱北京天安门";
                String keyword = "北海发布|猇亭|阿弓|阿市|安底|安底镇|安徽|安吉|安监局|安乐|安乐溪|安陆市|安洛|安洛乡|安庆|安全|八堡|八公山|巴东|白果|白龙|白泥|白沙|白石|白塔|白云|柏河|柏埔|百里杜鹃管委会|百纳|百兴|板底|板桥|板桥镇|蚌埠|蚌山|保安|保康|保宁|宝安|宝光|报国|北海|北海市|北航北海|北仑|北太平庄|北塘|北下关|贝墩|碧海|碧阳|滨河路|滨湖|滨江|博望|伯恩|补贴|财神|财政局|彩头|菜场|蔡甸|蔡郎|蔡中平|苍南|曹江|曹江镇|草池|草海|层台|茶场|茶地|茶点|茶园|茶园乡|岔河|拆楼|拆迁|硚口|常乐|常山|常州|长坝|长坝乡|长春堡|长虹|长坡|长坡镇|长沙|长石|长台|长兴|潮州|巢湖|车陂|陈岗|陈维|城东|城关|城管局|澄岭|池淮|池州|赤壁市|赤溪|崇安|崇阳|抽沙|滁州|川主乡|淳安|慈溪市|达溪|达依|大陈|大冲|大峨|大方|大岗|大关|大河|大街|大井|大井镇|大岭|大朋|大平|大坡|大坡咀|大坡镇|大桥|大桥头|大仁庙|大山|大水|大堂|大田|大田乡|大屯|大为|大为镇|大悟|大溪边|大新桥|大冶市|大银|大洲|大垌|代坪|丹江口市|当涂|当阳市|党江|德清|德溪|德卓|灯塔|点军|鼎新|定海|定新|东岸镇|东案|东宝|东大|东风|东关|东华|东南大学|东升|东升地|东西湖|东溪|东阳市|东岳|东莞|董地|洞头|斗古|杜集|杜泽|对江|对坡|掇刀|峨山|峨山镇|鄂城|鄂州|恩施|恩施市|二塘|法院|樊城|方旦|放珠|非法占地|肥东|肥西|分界镇|丰收|冯岗|奉化市|凤安|凤凰|凤林|凤山|凤台|凤阳|佛山|符平|符泉|符溪|浮石|福成|福芳|福利|福石|福田|辅处彝|府山|腐败|阜南|阜阳|富阳|附城镇|干河|甘家口|甘棠|钢铁|高淳|高德|高河|高家|高坪|高坪乡|高桥|高尚|高新|高州|根子镇|工商局|龚竹|供电局|公安|公安局|公馆|拱墅|沟溪|姑开|鼓场|鼓楼|古达|古丁|古丁|古丁居|古丁镇|古基|古塘|古竹|谷城|谷里|官冲|官商勾结|官寨|冠峨|观风海|观音桥|光凹|光明|光荣|广德|广水市|广州|规划局|桂果|桂花|桂花桥镇|桂花乡|桂林|贵池|锅圈岩|国土局|国资委|果瓦|哈喇河|海城|海淀|海拉|海宁市|海曙|海滩|海盐|海洋局|海洋生态|海子街|韩城|韩城市|含屋|汉川市|汉南|汉阳|杭州|航埠|好义|好义镇|荷花|荷花镇|荷叶|核桃|禾坑|和平|何官屯|何家|合肥|合江|合龙|合浦|合水口|合兴|河源|赫章|鹤峰|鹤市|贺垌|黑桥|黑社会|黑石头|黑水|黑土|黑土河|横岗|横山|洪湖市|洪山|洪水|宏严|红安|红光|红花|红林|红旗|红山|红星|猴场|后山|后山乡|后溪|后寨|胡场|湖镇|湖州|虎山|花溪|花园|花园路|华埠|华龙|华容|华墅|化觉|化觉乡|化起|化作|怀远|淮安|淮北|淮南|环保|环保局|黄布|黄店|黄冈|黄家|黄兰|黄龙|黄梅|黄泥|黄泥塘|黄沙|黄山|黄石|黄石港|黄坛口|黄塘|黄湾|黄湾乡|黄岩|黄州|黄陂|灰坪|辉埠|徽州|回龙|惠邻|惠山|惠阳|惠州|霍邱|霍山|积良|鸡场|绩溪|吉田|纪委|嘉善|嘉兴|嘉鱼|贾汪|监利|尖锋|建德市|建始|建邺|姜家山|江岸|江北|江场|江东|江干|江汉|江口|江陵|江门|江宁|江山|江山市|江苏|江夏|江阴市|椒江|交警支队|交通运输局|教育局|揭阳|结构|界首|金安|金碧|金城|金东|金斗|金华|金龙|金沙|金山|金坛|金钟|锦星|荆门|荆州|京山|景宁畲族自治|敬梓|镜湖|径山|净安|净居|九和|九华|九里镇|聚集|巨新|开化|砍人|柯城|柯桥|可乐|昆寨|垃圾|来凤|蓝思|蓝思科技|蓝塘|兰溪市|澜凼|郎溪|朗八|老凹坝|老河口市|乐都镇|乐清市|乐治|乐泗|雷场|雷岩|理化|李河|李伦兵|李蔚|里坑|丽水|利川市|利辛|联盟|联新|莲都|莲花|连峨|廉州|凉风|梁坎|梁子湖|亮岩|廖德全|烈山|猎德|林坝|林和|林家|林口|林泉|林山|林山青|林园|临安市|临海市|临江|临江镇|临泉|凌云|灵璧|岭洋|柳塘|柳塘镇|六安|六合|六龙|六曲河|龙场|龙场营|龙池|龙洞|龙洞|龙岗|龙华|龙街|龙马|龙门|龙门乡|龙门镇|龙泉市|龙上|龙亭镇|龙湾|龙窝|龙游|龙洲|隆街镇|庐江|庐阳|炉山|露华|路桥|鹿城|鹿泉|鹿塘|旅游|旅游局|绿化|绿塘|乱搭乱建|罗湖|罗家|罗目|罗田|罗州|骆湖|妈姑|麻城市|麻园|麻乍|马鞍山|马场|马贵镇|马金|马丽|马连洼|马路|马路乡|买官卖官|麦承标|猫场|茅箭|毛天|毛艳琼|茂名|梅州|蒙城|庙稿|庙下|民政局|民主|明星|明园|鸣凤|模环|木瓜|木禾塘|木孔|木孔乡|那射|纳雍|南长|南湖|南京|南康|南陵|南岭|南岭镇|南山|南通|南漳|南谯|南浔|年丰|宁波|宁国市|宁海|宁小平|牛场|牛棚|农业局|潘集|潘洲|磐安|炮子|彭鸣达|彭桥|彭寨|朋山|瓢井|坪山|平坝|平坝镇|平湖市|平山|平山|平山居委会|平山镇|平阳|普底|普陀|普兴乡|普宜|浦江|浦口|栖霞|七里|七星关|齐溪|祁门|千溪|前锋|前进|潜江|潜山|强征|侨港|秦淮|青场|青春|青龙|青龙桥|青山|青石|青田|青溪|青阳|清池|清池镇|清河|清湖|清华园|清水铺|清远|庆元|秋长白石|秋长镇|球川|曲樟|泉山|泉水|全椒|全旺|群达|仁耀垌|任严|日久冲|瑞安市|瑞邱|撒拉溪|三板桥|三江|三门|三台山|三塘|三元|桑树坪镇|桑园|沙包|沙厂|沙东|沙岗|沙河|沙井|沙市|沙田|沙土|沙土镇|沙溪乡|沙洋|山口|山美|汕头|汕尾|上城|上地|上方|上访|上坪寨|上义|上虞|上余|上庄镇|勺窝|韶关|少普|绍兴|射箭|社阳|深镇|深镇镇|深圳|神龙|生机|胜利|胜利镇|十里|十堰|石场|石场乡|石堆|石佛|石岗|石鼓|石鼓镇|石康|石梁|石炉|石门|石牌|石室|石首市|石湾|石仔岭|实兴|事故|市东|市西|市政协|曙光|曙光街|蜀山|双峨|双福|双福镇|双港|双河|双龙|双坪|双桥|双全|双山|双山新|双塔|双溪口|双邑|水东|水墩|水塘堡|水郁|水箐|顺河|四都|四季青|四季青镇|四桥|松林坡|松阳|苏家坨|苏镇|苏州|苏庄|素朴|宿迁|宿松|宿州|随州|遂昌|塔石|台州|泰顺|泰州|太来|太平|太平乡|太阳|太真|贪官|贪污|坛石|潭头|潭头镇|塘房|塘排|塘坞|塘源口|棠下|桃花|桃林|天池|天宫|天河|天河南|天门|天宁|天台|天园|田坝|田坝桥|田坎|田路|田坪|铁匠|铁山|铁山港|铁石|通城|通山|通衢|桐城|桐庐|桐乡市|同弓|同兴|铜官|铜陵|铜山|投诉|兔街|团风|团结|屯溪|瓦溪|瓦溪镇|碗窑|万福|万坎|万柳|万柳地|万年|万寿宫|万寿路|万田|汪坝|汪坪|王峰镇|王告|王山|望江|威宁|威奢|违法|违法建设|违规|桅杆|维新|卫生局|温岭市|温泉镇|温州|文昌|文成|文阁|文化局|文庙街|涡阳|乌家|乌石镇|污染|无锡|芜湖|梧峰|梧桐|吴岗|吴兴|武昌|武汉|武进|武警|武穴市|武义|五爱|五里|五龙|五山|五星|伍国辉|伍家岗|物价局|西北旺|西北旺镇|西场|西湖|西陵|西洛|西塞山|西三旗|西庄镇|锡场|锡山|溪口|峡川|峡口|下城|下陆|夏荷|仙居|仙塘|仙桃|仙牙|仙钟|咸安|咸丰|咸宁|香港|香山|襄城|襄阳|襄州|湘潭|响水|象山|萧山|小古|小海|小河|小吉场|小南海|小屯|孝昌|孝感|孝南|协和|谢鸡|谢鸡镇|谢向阳|新北|新昌|新城|新发|新房|新复|新港|新华|新化|新化乡|新建|新乐|新联|新龙|新路|新民|新平乡|新桥|新仁|新塘|新塘边|新新|新沂市|新圳|新垌|新垌镇|信安|星岛湖|星沙|星宿|兴发|兴宏|兴华|兴隆|兴容|兴山|幸福|熊岗|熊家场|休宁|秀水|秀洲|徐州|宣城|宣恩|宣州|玄武|学院路|雪山|鸭池|盐仓|盐城|盐田|岩孔|燕岗|燕园|燕子口|杨河|杨家湾|杨林|杨柳|杨铺|杨漩|扬州|羊场|羊坊店|羊街|阳长|阳江|阳新|瑶海|野角|野马川|夷陵|宜昌|宜城市|宜都市|宜兴市|宜秀|以那|义安|义容|义乌市|音坑|阴底|银海|银滩|英山|应城市|营盘|永燊|永安|永定路|永光|永嘉|永康市|永坑|优胜|友爱|友谊|淤头|余杭|余姚市|渔政|雨冲|雨朵|雨花台|禹会|禹谟|禹谟镇|玉环|玉坑塘|玉龙|玉山|裕安|元岗|袁岗|源镇|远安|远光|越城|岳西|月南|云浮|云贵|云海|云和|云龙|云梦|云潭|云潭镇|云溪|郧西|郧阳|宰客|枣阳市|曾都|闸口|寨乐|詹家|占地|战斗|湛江|樟坑|樟潭|张坝|张岗|张家湾|张山|张湾|张岩|招贤|赵河|赵增连|肇庆|哲觉|哲庄|浙江|镇海|镇江|镇江|镇江镇|征地|政法委|芝川镇|芝阳镇|枝江市|织金|执法犯法|纸厂|质监|中坝|中关|中建|中坪|中山|中水|中王|中兴|中寨|钟鼓|钟楼|钟山|钟祥市|重新|舟山|周家|周山|珠藏|珠海|珠吉|珠市|朱昌|朱明|猪场|诸暨市|竹山|竹溪|竹园|住建局|庄田|状元街|紫城|紫金|紫市镇|紫竹院|自来水公司|自强|鬃岭|左鶂嘎|廿八都|廿里|厍东关|佗城|亳州|谯城|陂头镇|邳州市|鄞州|蕲春|弋江|岚头|岚头镇|岱山|嵬东镇|嵊州市|嵊泗|衢江|衢州|沐尘畲族|泗水|泗水镇|泮水塘|涠洲岛|浠水|溧水|溧阳市|濉溪|迤那|婺城|缙云|幺站|枞阳|楠香|瓯海|昝镇|旌德|砀山|睢宁|雉街|秭归|鸠江|颍东|颍泉|颍上|颍州|抢劫|闹事|传销|污水|地沟油|火灾|豆腐渣|非法|扰民|城管|误诊|纠纷|维权|讨薪|欠薪|罢工|游行|乱收费|保护费|跳楼|示威|横幅|举报|抗议|上访|黑幕|内幕|曝光|私吞|职权|挪用|不作为|敲诈|涉黑|黑恶势力|黑心|强拆|违建|违法|村霸|拖欠|包庇|行贿|犯法|贿赂|欺诈|治安|警察|警车|民警|公安|派出所|打人|打架|堵路|拦路|声讨|游街|条幅|殴打|黑社会|黑吃黑|贩毒|吸毒|毒品|暴力|抢劫|小偷|劫持|绑架|砍人|捅伤|捅死|家暴|暴打|警车|爆炸|炸弹|恐怖组织|群殴|群体事件|群架|打砸|传销|跳楼|自杀|杀人|潜逃|敲诈|勒索|涉黑|恶势力|比亚迪|byd|沙田|讨薪|东风日产|日产|nissan";
                PrismUtil.addTerm(PrismUtil_r.ALARM_SEARCH_SYSTEM_NAME, PrismUtil_r.MAPPING_TYPE_ALARM, keyword, "585");
                List<DataBeanParent> list = new ArrayList<>();
                DataBeanParent article = new DataBeanParent();
                article.setText(text);
                article.setTitle(title);
                list.add(article);
                PrismUtil.getWordMatchSubIds(PrismUtil_r.ALARM_SEARCH_SYSTEM_NAME, PrismUtil_r.MAPPING_TYPE_ALARM, list);
            } catch (Exception e) {
                e.printStackTrace();
            }
        };
       for (int i=0;i<1;i++)
           new Thread(runnable).start();
    }

//    public static void PrismForMysqlTest() throws Exception {
//        com.ali.retail.utils.prism_m.PrismUtil.init();//初始化prism实例
//        com.ali.retail.utils.prism_m.PrismUtil.addTerms();//初始化prism库
//        com.ali.retail.utils.prism_m.PrismUtil.addTerm("特朗普|朗姆", "123");
//        String text = "字母天堂:let's dance!桃源村别有洞天桃源村怎么了2女童.上海瑰丽多彩,深圳南山波澜壮阔.武汉加油,中国加油!";
//        String title = "我爱北京天安门";
//        com.ali.retail.utils.prism_m.PrismUtil.getWordMatchExpressionIds(text, title);
//    }
}
